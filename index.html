<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Katalog</title>
  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <!-- ===== BACKGROUND MUSIC (GLOBAL) ===== -->
  <audio id="bgm" loop preload="auto">
    <source src="assets/bgm.mp3" type="audio/mpeg">
  </audio>
  <!-- ===== /BACKGROUND MUSIC ===== -->

  <!-- ===== WELCOME OVERLAY ===== -->
  <div id="welcomeOverlay" class="welcome-overlay" aria-hidden="true">
    <div class="welcome-card">
      <div class="welcome-glow"></div>

      <div class="welcome-image">
        <img src="Welcome.png" alt="Welcome Kyusei">
      </div>

      <h2 class="welcome-title">âœ¨ Selamat Datang âœ¨</h2>

      <p class="welcome-text">
        Selamat datang di <b>Kyusei Store</b><br>
        Tempat jual akun game pilihan âœ¨<br>
        Silakan pilih game & akun favoritmu.
      </p>

      <button id="welcomeBtn" class="welcome-btn" type="button">
        Masuk âœ¨
      </button>
    </div>
  </div>
  <!-- ===== /WELCOME OVERLAY ===== -->

  <header class="topbar">
    <div class="wrap">
      <div class="topbar__inner">
        <div class="topbar__text">
          <h1 id="siteName">Kyusei</h1>
          <p class="sub">Klik produk untuk lihat detail & foto</p>
        </div>

        <div class="topbar__actions">

          <!-- RESUME PANEL (UI baru) -->
          <div class="resumeWrap" id="resumeWrap">
            <a id="resumeProduct" class="resumeChip" style="display:none" href="#">
              <span class="resumeIco">ðŸ§¾</span>
              <span class="resumeTxt">
                <b>Lanjutkan</b><small>produk terakhir</small>
              </span>
              <span class="resumeGo">â€º</span>
            </a>

            <a id="resumePay" class="resumeChip isPrimary" style="display:none" href="#">
              <span class="resumeIco">ðŸ’³</span>
              <span class="resumeTxt">
                <b>Lanjutkan</b><small>pembayaran terakhir</small>
              </span>
              <span class="resumeGo">â€º</span>
            </a>
          </div>
          <!-- /RESUME PANEL -->

          <!-- Piringan Musik -->
          <div id="musicDisc" class="music-disc" title="Play / Pause Music"></div>

          <!-- LOGO + DROPDOWN -->
          <div class="menu">
            <button class="logoBtn" id="logoBtn" data-tip="Pilih Game" aria-haspopup="true" aria-expanded="false" type="button">
              <img src="./LOGO.jpg" alt="Logo Kyusei" />
            </button>

            <div class="dropdown" id="dropdown" aria-hidden="true">
              <button class="ddItem" data-game="all" type="button">Semua</button>
              <button class="ddItem" data-game="genshin" type="button">Genshin Impact</button>
              <button class="ddItem" data-game="toram" type="button">Toram Online</button>
              <button class="ddItem" data-game="ml" type="button">Mobile Legends</button>
              <button class="ddItem" data-game="ff" type="button">Free Fire</button>
            </div>
          </div>
          <!-- /LOGO + DROPDOWN -->

        </div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section id="grid" class="grid"></section>
  </main>

  <script src="./data.js?v=999"></script>
  <script src="./index.js?v=999"></script>

  <!-- ===== WELCOME + MUSIC (SAFE) ===== -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const overlay = document.getElementById("welcomeOverlay");
      const btn = document.getElementById("welcomeBtn");
      const bgm = document.getElementById("bgm");
      const disc = document.getElementById("musicDisc");

      // ---- MUSIC RESUME LINTAS HALAMAN ----
      if (bgm) {
        bgm.volume = 0.2;
        bgm.load();

        // kalau sebelumnya user nyalain musik, coba lanjutkan (autoplay bisa diblokir)
        if (localStorage.getItem("bgm_playing") === "1") {
          bgm.play().then(() => {
            disc && disc.classList.add("playing");
          }).catch(() => {
            // normal kalau diblokir
            disc && disc.classList.remove("playing");
          });
        }

        // update icon disk
        bgm.addEventListener("play", () => {
          localStorage.setItem("bgm_playing","1");
          disc && disc.classList.add("playing");
        });
        bgm.addEventListener("pause", () => {
          localStorage.setItem("bgm_playing","0");
          disc && disc.classList.remove("playing");
        });
      }

      // klik disk = toggle
      if (disc && bgm) {
        disc.addEventListener("click", async () => {
          try {
            if (bgm.paused) await bgm.play();
            else bgm.pause();
          } catch (e) {
            alert("Audio tidak bisa diputar. Pastikan file ada di ./assets/bgm.mp3");
            console.log(e);
          }
        });
      }

      // ---- WELCOME MUNCUL TIAP BUKA WEB (per sesi/tab) ----
      if (overlay && btn) {
        if (!sessionStorage.getItem("welcome_seen")) {
          overlay.classList.add("show");
          overlay.setAttribute("aria-hidden","false");
        }

        const closeWelcome = async () => {
          overlay.classList.remove("show");
          overlay.setAttribute("aria-hidden","true");
          sessionStorage.setItem("welcome_seen","1");

          // BONUS: nyalain musik setelah klik "Masuk" (diizinkan browser)
          if (bgm) {
            try {
              bgm.volume = 0.2;
              await bgm.play();
              localStorage.setItem("bgm_playing","1");
            } catch (e) {
              console.log("Music blocked:", e);
            }
          }
        };

        btn.addEventListener("click", closeWelcome);
        overlay.addEventListener("click", (e) => {
          if (e.target === overlay) closeWelcome();
        });

        // HP kadang balik dari cache, pastikan welcome tetap muncul kalau belum klik
        window.addEventListener("pageshow", () => {
          if (!sessionStorage.getItem("welcome_seen")) {
            overlay.classList.add("show");
            overlay.setAttribute("aria-hidden","false");
          }
        });
      }
    });
  </script>
  <!-- ===== /WELCOME + MUSIC ===== -->
</body>
</html>









